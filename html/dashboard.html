<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Client Dashboard | One Layer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="stylesheet" href="../assets/libs/bootstrap/dist/css/bootstrap.min.css">
</head>

<body class="bg-light">

  <!-- TOP BAR -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">One Layer</a>
      <button class="btn btn-outline-danger btn-sm" id="logoutBtn">Logout</button>
    </div>
  </nav>

  <h6 class="fw-bold mb-3">Client Menu</h6>
  <ul class="list-unstyled">
    <li class="mb-2">
      <button class="btn btn-link p-0 menu-link" data-section="projects">📊 Work Progress</button>
    </li>
    <li class="mb-2">
      <button class="btn btn-link p-0 menu-link" data-section="reports">📅 Weekly Reports</button>
    </li>
    <li class="mb-2">
      <button class="btn btn-link p-0 menu-link" data-section="invoices">💳 Billing & Invoices</button>
    </li>
    <li class="mb-2">
      <button class="btn btn-link p-0 menu-link" data-section="tickets">🎧 Support Tickets</button>
    </li>
    <li class="mb-2">
      <button class="btn btn-link p-0 menu-link" data-section="account">⚙️ Account Settings</button>
    </li>
  </ul>
  </div>
  </div>
  </div>

  <!-- MAIN PANEL -->
  <div class="col-md-9">
    <div class="card shadow-sm">
      <div class="card-body">
        <h4 class="fw-bold mb-3">Welcome to Your Virtual Office</h4>
        <p class="text-muted">
          Here you can track your project progress, reports, payments, and support.
        </p>

        <!-- DASHBOARD STATS -->
        <div class="row g-3 mt-4">
          <div class="col-md-4">
            <div class="p-3 bg-primary text-white rounded">
              <h6>Active Projects</h6>
              <h3 id="stat-projects">0</h3>
            </div>
          </div>
          <div class="col-md-4">
            <div class="p-3 bg-success text-white rounded">
              <h6>Reports</h6>
              <h3 id="stat-reports">0</h3>
            </div>
          </div>
          <div class="col-md-4">
            <div class="p-3 bg-warning text-dark rounded">
              <h6>Pending Invoices</h6>
              <h3 id="stat-invoices">₹0</h3>
            </div>
          </div>
        </div>

        <!-- SECTION CONTENT -->
        <div id="dashboard-content" class="mt-4">

          <div id="section-projects" class="dashboard-section d-none">
            <h5>Work Progress</h5>
            <div id="projectsList" class="mt-3"></div>
          </div>

          <div id="section-reports" class="dashboard-section d-none">
            <h5>Weekly Reports</h5>
            <div id="reportsList" class="mt-3"></div>
          </div>

          <div id="section-invoices" class="dashboard-section d-none">
            <h5>Invoices</h5>
            <div id="invoicesList" class="mt-3"></div>
          </div>

          <div id="section-tickets" class="dashboard-section d-none">
            <h5>Support Tickets</h5>
            <div id="ticketsList" class="mt-3"></div>
          </div>

          <div id="section-account" class="dashboard-section d-none">
            <h5>Account Settings</h5>
            <p class="text-muted mt-2">Profile info will load here...</p>
          </div>

        </div>

      </div>
    </div>
  </div>

  </div>
  </div>

  <!-- SCRIPTS -->
  <script type="module" src="../assets/js/supabase.js"></script>
  <script type="module" src="../assets/js/auth-guard.js"></script>
  <script type="module" src="../assets/js/dashboard.js"></script>
  <script src="../assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>


  <!-- Layer Navigation Sidebar -->
  <div class="layer-sidebar" id="layerSidebar">
    <div class="layer-links-wrapper">
      <a href="foundation-layer.html" class="layer-link" data-layer="foundation">Foundation Layer</a>
      <a href="growth-layer.html" class="layer-link" data-layer="growth">Growth Layer</a>
      <a href="scale-layer.html" class="layer-link" data-layer="scale">Scale Layer</a>
      <a href="enterprise-layer.html" class="layer-link" data-layer="enterprise">Enterprise Layer</a>
      <a href="global-layer.html" class="layer-link" data-layer="global">Global Layer</a>
      <a href="data-security-layer.html" class="layer-link" data-layer="data-security">Data & Security Layer</a>
    </div>
  </div>

  <script>
    (function () {
      const sidebar = document.getElementById('layerSidebar');
      const bannerSection = document.querySelector('.banner-section');
      const footer = document.querySelector('footer');
      const menuToggle = document.querySelector('.toggle-menu');

      function updateSidebarVisibility() {
        const scrollY = window.scrollY;
        const windowHeight = window.innerHeight;
        const bannerBottom = bannerSection ? bannerSection.offsetTop + bannerSection.offsetHeight : 0;
        const footerTop = footer ? footer.offsetTop : document.body.scrollHeight;
        const viewportBottom = scrollY + windowHeight;
        const menuOpen = menuToggle && menuToggle.getAttribute('aria-expanded') === 'true';

        if (scrollY < bannerBottom - 100 || viewportBottom > footerTop - 50 || menuOpen) {
          sidebar.classList.add('hidden');
        } else {
          sidebar.classList.remove('hidden');
        }
      }

      window.addEventListener('scroll', updateSidebarVisibility);
      window.addEventListener('resize', updateSidebarVisibility);
      document.addEventListener('click', updateSidebarVisibility);
      if (menuToggle) {
        menuToggle.addEventListener('click', function () {
          setTimeout(updateSidebarVisibility, 50);
        });
      }
      updateSidebarVisibility();
    })();
  </script>

</body>

</html>